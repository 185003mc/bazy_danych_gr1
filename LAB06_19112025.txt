SELECT AVG(pensja) FROM employee;
SELECT job_position_id, AVG(pensja) FROM employee GROUP BY job_postion_id;
SELECT department_id, AVG(TIMESTAMPDIFF(YEAR, birth_date, CURDATE())) FROM employee GROUP BY departent_id;
zad2
SELECT dperatment_id, SUM(pensja) as total_pensja FROM employee GROUP BY department_id ORDER BY total_pensja DESC;
SELECT job_position_id, AVG(pensja),COUNT(*) as employee_count FROM EMPLOYEE GROUP BY job_position_id HAVING COUNT(*) >=3 AND AVG(pensja) > 3000;
SELECT department_id, COUNT(DISTINCT pensja) AS dis_pensja, COUNT(*) AS emplo_cnt FROM employee GROUP BY department_id HAVING COUNT(*) > 3 ORDER BY distinct_salaries ASC;
zad3
CREATE TABLE depratment_c AS SELECT* FROM depertment;
CREATE TABLE job_position_c AS SELECT * FROM job_position;
	
SELECT d.department_name, COUNT(e.employee_id) AS emp_cnt FROM department d LEFT JOIN employee e ON D.department_id = e.department_id, GROUP BY d.department_id, d.department_name;
SELECT d.department_name, GROUP_CONCAT(CONCAT(e.first_name, ' ', e.last_name) ORDER BY e.last_name SEPARATOR ', ') AS pracownicy FROM department d LEFT JOIN employee e ON e.department_id = d.department_id;

Zad4
SELECT e.last_name, j.job_name FROM employee e JOIN job_position j ON e.job_position = j.job_position WHERE YEAR (e.birth_date) BETWEEN 1990 AND 1999;

SELECT e.first_name,e.last_name, e.birth_date FROM employee e JOIN job_position j ON e.job_position = j.job_position_id WHERE j.job_name = 'magazynier' ORDER BY e.birth_date DESC LIMIT 5;

SELECT c1.client_id, c1.short_name AS client1, c2.client_id, c2.short_name AS client2 FROM client c1 JOIN client c2 ON c1.client_id  + 5 = c2.client_id ORDER BY c1.client_id;

ZAD 5.

SELECT e.JOB_POSITIION_ID, AVG(pensja) AS avg_pensja, COUNT(*) AS employee_cnt FROM EMPLOYEE e JOIN department d ON e.department_id = d.department WHERE d.department_name NOT IN ('IT', 'HR') group by e.job_position_id HAVING COUNT(*) > 3;

SELECT job_position_id, MIN(birth_date) as oldest, MAX(birth_date) AS youngest, DEPARTMENT_ID FROM EMPLOYEE GROUP BY job_position_id, department_id; 

